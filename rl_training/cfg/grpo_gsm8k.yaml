# grpo_gsm8k.yaml   â€“  starter settings for smoke-tests
# ----------------------------------------------------
# Anything in this file is passed verbatim to RolloutCollector via cfg.
# The GRPO trainer will later read the same file and use only what it needs.

# -------------- rollout collector ---------------- #
num_generations   : 8
num_prompts       : 4
max_new_tokens    : 128
temperature       : 0.7
top_p             : 0.9

reward_var_thresh : 0.0
reject_all_zero   : true
reject_all_max    : true

reward_fns:
  - tag_math_correct

scheduler:
  name          : mix_passrate
  dataset_name  : gsm8k
  split         : "train"
  ema_alpha     : 0.05
  boundaries    : [0.2, 0.8]
  sample_weights: [4, 3, 1]

# ------------------ trainer (GRPO) --------------- #
lr               : 2.0e-5
clip_eps         : 0.2
kl_beta          : 0.01
ent_coef         : 0.0            # future entropy bonus knob
grad_clip        : 1.0
bf16             : true

grad_accum_steps : 8
gradient_checkpointing : true


